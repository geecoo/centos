#!/usr/bin/bash

# echo $(dirname $BASH_SOURCE)
BIN_DIR=$(cd `dirname $0`;pwd -P)
ROOT_DIR=$(dirname $BIN_DIR)

# Scripts directory
CONF_DIR="$ROOT_DIR/conf"
LOG_DIR="$ROOT_DIR/log"
SRC_DIR="$ROOT_DIR/src"
TAR_DIR="$ROOT_DIR/storage/tar"

# load config
. ${CONF_DIR}/*

# load functions
. /etc/init.d/functions
. "$SRC_DIR/framework/lib/functions" 
. "$SRC_DIR/framework/lib/argsparser" 
. "$SRC_DIR/framework/lib/filter" 
. "$SRC_DIR/framework/interactive" 
. "$SRC_DIR/framework/lib/cooclt" 

################   Bootstrap loaded completed. ######################

# COO_MODULE        模块名
# COO_MODULE_DIR    模块路径
# COO_DO            执行体名
# COO_DO_SCRIPT     执行体路径

## 解析参数 ##
argsparser $@

## 解析不到， 进入交互系统

if [ ! "$COO_MODULE" ];then
    __echo_warning "The param '-m | --module' could not be found." 

    __echo_warning "Automatically entered into the interactive system." 

    bootstrap_interactive
fi

invoker

if [[ "$?" -ne 0 ]]
then
    __echo_warning "Script invoker failed." 
    exit 0
fi

__echo_success "Script invoker success." 
